<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Alice Linux - docs</title>
	<style>
	body {
		font-family: monospace;
		font-size: 14px;
		line-height: 1.25;
		max-width: 60em;
		margin-left: auto;
		margin-right: auto;
		padding-left: 1em;
		padding-right: 1em;
		background-color: #242424;
		color: #fefefe;
	}
	pre {
		background-color: #2b2b2b;
		border-radius: 3px;
		padding: 10px;
		overflow-x: auto;
	}
	code {
		color: #f7f3d6;
	}
	img {
		display: block;
		max-width: 100%;
	}
	hr {
		border: 0;
		border-top: 1px dashed #fefefe;
		margin: 20px 0;
	}
	table {
		width: 100%;
		border-collapse: collapse;
	}
	th, td {
		padding: 4px;
	}
	th {
		background-color: #2b2b2b;
	}
	table, th, td {
		border: 2px dashed #2b2b2b;
	}
	a {
		color: #90cbf9;
		text-decoration: none
	}
	a:hover {
		color: #869edc;
		text-decoration: underline
	}
	</style>
</head>
<body>
<div class="centered-wrapper">
	<h1>docs</h1>
	<a href="/">home</a> / <a href="/docs">docs</a> / <a href="https://codeberg.org/emmett1/alicelinux">development</a> / <a href="https://codeberg.org/emmett1/alicelinux/releases">download</a> / <a href="https://sourceforge.net/projects/alice-linux/files/iso/">iso</a> / <a href="/community.html">community</a> / <a href="/donate.html">donate</a>
	<hr>
<h1>Install Alice</h1>
<p>Here is a guide to installing Alice Linux on your computer using the chroot method. You can do this from your existing Linux distribution or from a live environment, such as Alice Live or another Linux distribution. Make sure your chosen environment has the necessary partitioning tools, filesystem tools, and extraction tools.</p>
<h2>Get Alice rootfs tarball</h2>
<p>Download the Alice rootfs tarball from the <a href="https://codeberg.org/emmett1/alicelinux/releases">release</a> page, along with its <code>sha256sum</code> file.
</p>
<pre><code>$ curl -O &lt;url&gt;
$ curl -O &lt;url&gt;.sha256sum
</code></pre>
<p>Verify the checksum of the Alice rootfs tarball:</p>
<pre><code>$ sha256sum -c alicelinux-rootfs-20240525.tar.xz.sha256sum
</code></pre>
<p>Make sure it prints:
</p>
<pre><code>alicelinux-rootfs-20240525.tar.xz: OK
</code></pre>
<h2>Prepare the partition and filesystem</h2>
<p>Prepare the partition and filesystem of your choice. In this guide, I will use ext4 as an example.
</p>
<pre><code># cfdisk /dev/sdX
# mkfs.ext4 /dev/sdXY
</code></pre>
<p>Mount your created partition somewhere. In this guide, I will use /mnt/alice as the mount point.
</p>
<pre><code># mkdir /mnt/alice
# mount /dev/sdXY /mnt/alice
</code></pre>
<h2>Extract the Alice rootfs tarball</h2>
<p>Extract the Alice rootfs into the mounted partition.
</p>
<pre><code>$ tar xvf alicelinux-rootfs-*.tar.xz -C /mnt/alice
</code></pre>
<h2>Enter chroot</h2>
<p>First, chroot into Alice. (Replace /mnt/alice with your chosen mount point.)
</p>
<pre><code># /mnt/alice/usr/bin/apkg-chroot /mnt/alice
</code></pre>
<p>Any further commands after this will be executed inside the Alice environment. </p>
<h2>Clone Alice repos</h2>
<p>Fetch the Alice packages repositories somewhere. I'll fetch them inside the /var/lib directory to keep the system clean.
</p>
<pre><code># cd /var/lib
# git clone --depth=1 https://codeberg.org/emmett1/alicelinux
</code></pre>
<p>Once we have the repositories cloned, we need to configure <code>apkg</code>. <code>apkg</code> is Alice's package build system (or package manager). By default, Alice does not provide an <code>apkg</code> config file (yes, <code>apkg</code> can work without a config file), but we need to create one. The <code>apkg</code> config file should be located at <code>/etc/apkg.conf</code> by default. Let's create one. </p>
<h2>Configure apkg.conf</h2>
<p>First, we set <code>CFLAGS</code> and <code>CXXFLAGS</code>. Alice base packages are built using <code>-O3 -march=x86-64 -pipe</code>. You can use these settings or change them to your preference.
</p>
<pre><code># echo 'export CFLAGS=&quot;-O3 -march=x86-64 -pipe&quot;' &gt;&gt; /etc/apkg.conf
</code></pre>
<p>And use whats in <code>CFLAGS</code> for <code>CXXFLAGS</code>.
</p>
<pre><code># echo 'export CXXFLAGS=&quot;$CFLAGS&quot;' &gt;&gt; /etc/apkg.conf
</code></pre>
<p>Next set <code>MAKEFLAGS</code>. I will use <code>6</code> for my <code>8 threads</code> machine.
</p>
<pre><code># echo 'export MAKEFLAGS=&quot;-j6&quot;' &gt;&gt; /etc/apkg.conf
</code></pre>
<p>I'm also going to set <code>NINJAJOBS</code> here. Without it, <code>ninja</code> will use all threads of your machine when compiling.
</p>
<pre><code># echo 'export NINJAJOBS=&quot;6&quot;' &gt;&gt; /etc/apkg.conf
</code></pre>
<p>Next, we need to set the package's build scripts path (I'll call it <code>package repos</code>) so <code>apkg</code> can find them. The <code>APKG_REPO</code> variable can accept multiple values for multiple <code>package repos</code>.</p>
<p>Alice provides four (4) <code>package repos</code> (at the time of this writing): <code>core</code>, <code>extra</code>, <code>xorg</code> and <code>wayland</code>. <code>core</code> contains all base packages, and <code>extra</code> includes other packages beyond the base. <code>xorg</code> and <code>wayland</code> contain packages for gui and their dependencies.</p>
<p>First, get the absolute path of the <code>package repos</code> where we cloned them. By the way, we are still inside the <code>/var/lib</code> directory where we cloned the repo.
</p>
<blockquote><p>NOTE: USE TAB COMPLETION!</p>
</blockquote>
<pre><code># realpath alicelinux/repos/core
/var/lib/alicelinux/repos/core
# realpath alicelinux/repos/extra
/var/lib/alicelinux/repos/extra
</code></pre>
<p>After we have the path of our <code>package repos</code>, add it to the <code>APKG_REPO</code> variable in <code>/etc/apkg.conf</code>.
</p>
<pre><code># echo 'APKG_REPO=&quot;/var/lib/alicelinux/repos/core /var/lib/alicelinux/repos/extra&quot;' &gt;&gt; /etc/apkg.conf
</code></pre>
<blockquote><p>NOTE: All repo paths must be declared in the APKG<em></em>EPO variable, seperated by a single space.</p>
</blockquote>
<p> 
After setting up our <code>package repos</code>, make sure <code>apkg</code> can find the packages. We can use <code>apkg -s &lt;pattern&gt;</code> to search for packages.
</p>
<pre><code># apkg -s sway
swayidle
swaybg
swaylock
sway
</code></pre>
<p>If the output appears, then we are good to go.</p>
<p>Next, we will set up directories for <code>packages</code>, <code>sources</code>, and <code>work</code>. By default, these directories are inside the package template, but we will change them to <code>/var/cache/pkg</code>, <code>/var/cache/src</code>, and <code>/var/cache/work</code> respectively. You can change these to any location where you want to store these files.</p>
<p>First, create the directories:
</p>
<pre><code># mkdir -p /var/cache/pkg
# mkdir -p /var/cache/src
# mkdir -p /var/cache/work
</code></pre>
<p>Then add these paths to <code>/etc/apkg.conf</code>.
</p>
<pre><code># echo 'APKG_PACKAGE_DIR=/var/cache/pkg' &gt;&gt; /etc/apkg.conf
# echo 'APKG_SOURCE_DIR=/var/cache/src' &gt;&gt; /etc/apkg.conf
# echo 'APKG_WORK_DIR=/var/cache/work' &gt;&gt; /etc/apkg.conf
</code></pre>
<h2>Full system upgrade/rebuild</h2>
<p>On the first install, we should upgrade the system first.
</p>
<blockquote><p>NOTE: Use uppercase <code>U</code> for a system upgrade, and lowercase <code>u</code> to upgrade a specific package of your choice.</p>
</blockquote>
<pre><code># apkg -U
</code></pre>
<p>If you changed <code>CFLAGS</code> and <code>CXXFLAGS</code> to something other than the default, it's a good time to perform a full rebuild first. In this case, you can skip upgrading the system because performing a full rebuild will already use the latest version in <code>package repos</code>.</p>
<blockquote><p>NOTE: Add the <code>-f</code> flag to force rebuild of existing prebuilt package.
NOTE: <code>apkg -a</code> prints all installed packages on the system.</p>
</blockquote>
<pre><code># apkg -u $(apkg -a)
</code></pre>
<h2>Install development packages</h2>
<p>Before installing any additional packages, we need to install development packages.
</p>
<pre><code># apkg -I meson cmake pkgconf libtool automake perl
</code></pre>
<h2>Install kernel</h2>
<p>You can configure your own kernel from <a href="https://kernel.org/">kernel.org</a> or use the one provided by Alice.
</p>
<blockquote><p>NOTE: The provided kernel will take a lot of time to compile because many options are enabled.</p>
</blockquote>
<p>If you want to use Alice's kernel, just run:
</p>
<pre><code># apkg -I linux
</code></pre>
<h2>Install firmware</h2>
<p>If your hardware requires firmware, install it using:
</p>
<pre><code># apkg -I linux-firmware linux-firmware-nvidia
</code></pre>
<h2>Install bootloader</h2>
<p>In this guide, I'm going to use <code>grub</code> as the bootloader. Install <code>grub</code>:
</p>
<pre><code># apkg -I grub
</code></pre>
<p>Then generate grub config:
</p>
<pre><code># grub-install /dev/sdX
# grub-mkconfig -o /boot/grub/grub.cfg
</code></pre>
<h2>Hostname</h2>
<p>Change <code>alice</code> to the hostname of your choice.
</p>
<pre><code># echo alice &gt; /etc/hostname
</code></pre>
<h2>Fstab</h2>
<p>Change the partition and filesystem of your choice below:
</p>
<pre><code># echo '/dev/sda1 swap swap defaults 0 1' &gt;&gt; /etc/fstab
# echo '/dev/sda2 / ext4 defaults 0 0' &gt;&gt; /etc/fstab
</code></pre>
<h2>Enable runit services</h2>
<p>Alice uses busybox's <code>runit</code> as its main service manager. Enable the required services:
</p>
<pre><code># ln -s /etc/sv/tty1 /var/service
# ln -s /etc/sv/tty2 /var/service
# ln -s /etc/sv/tty3 /var/service
</code></pre>
<p>I'm enabling 3 <code>tty</code> services. <code>tty</code> is required; without it, you won't be able to log in (or run any commands).
</p>
<blockquote><p>The runit service directory is <code>/etc/sv</code>.
Create a symlink from <code>/etc/sv/&lt;service&gt;</code> to <code>/var/service</code> to enable it; remove the symlink to disable it.</p>
</blockquote>
<h2>Setup user and password</h2>
<p>Add your user:
</p>
<pre><code># adduser &lt;user&gt;
</code></pre>
<p>Add your user to the <code>wheel</code> group:
</p>
<pre><code># adduser &lt;user&gt; wheel
</code></pre>
<p>You might need to add your user to the <code>input</code> and <code>video</code> groups to start the Wayland compositor later, and the <code>audio</code> group to have working audio:
</p>
<pre><code># adduser &lt;user&gt; input
# adduser &lt;user&gt; video
# adduser &lt;user&gt; audio
</code></pre>
<h2>Root password</h2>
<p>Set the password for the <code>root</code> user:
</p>
<pre><code># passwd
</code></pre>
<h2>Networking</h2>
<p>You might want to set up networking before rebooting. Use <code>wpa_supplicant</code> and <code>dhcpcd</code>.
</p>
<pre><code># apkg -I wpa_supplicant dhcpcd
</code></pre>
<p>Configure your SSID:
</p>
<pre><code># wpa_passphrase &lt;YOUR SSID&gt; &lt;ITS PASSWORD&gt; &gt;&gt; /etc/wpa_supplicant.conf
</code></pre>
<p>Enable the service:
</p>
<pre><code># ln -s /etc/sv/wpa_supplicant /var/service
# ln -s /etc/sv/dhcpcd /var/service
</code></pre>
<h2>Timezone</h2>
<p>Install <code>tzdata</code>:
</p>
<pre><code># apkg -I tzdata
</code></pre>
<p>Then create a symlink for your timezone to <code>/etc/localtime</code>:
</p>
<pre><code># ln -s /usr/share/zoneinfo/Asia/Kuala_Lumpur /etc/localtime
</code></pre>
<p>Alternatively, you can copy it and then uninstall <code>tzdata</code> to keep your installed packages minimal:
</p>
<pre><code># cp /usr/share/zoneinfo/Asia/Kuala_Lumpur /etc/localtime
# apkg -r tzdata
</code></pre>
<h2>Reboot and enjoy!</h2>
<p>Exit the chroot environment and unmount the Alice partition, then reboot:
</p>
<pre><code># exit
# umount /mnt/alice
# reboot
</code></pre>
<h1>Some important notes</h1>
<ul>
<li><code>Alice</code> uses <code>spm</code> and <code>apkg</code> as its package manager and package build system. Run with the <code>-h</code> flag to see available options.</li>
<li>Additional scripts are provided with the name <code>apkg-&lt;script&gt;</code> which will be added (or removed) from time to time.</li>
<li>Use <code>revdep</code> to scan for broken libraries and binaries after system upgrades and package removals. You can use <code>revdep -v</code> to print out missing required libraries, and use <code>apkg -f -u $(revdep)</code> to scan and rebuild broken packages.</li>
<li>Run <code>updateconf</code> to update config files in <code>/etc</code> after package upgrades.</li>
</ul>
	<br><hr>
	<p>Copyright (C) Alice Linux, 2024</p>
</div>
</body>
</html>
